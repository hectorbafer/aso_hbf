#  PR0601: Introducci贸n a Powershell

>  Para hacer los ejercicios, se pondr谩 los apartados que pide cada ejercicio, el comando que se usa y el resultado de ese comando.

##  1. Descubrimiento y ayuda
- **B煤squeda por nombre (Sustantivo):** lista todos los comandos disponibles en el sistema que tengan la palabra `Service` en su nombre (noun) para identificar qu茅 herramientas tienes para gestionar servicios.

```powershell
Get-Command -Noun Service
```

![Busqueda por nombre](Imagenes/Ej1.png)

- **B煤squeda por acci贸n (Verbo):** lista todos los comandos disponibles cuya acci贸n sea `Stop` (detener), independientemente de lo que detengan.

```powershell
Get-Command -Verb Stop
```

![Busqueda por nombre](Imagenes/Ej1_1.png)

- **Uso de la ayuda:** muestra por pantalla la ayuda detallada del comando `Get-Process`, pero aseg煤rate de que se muestren espec铆ficamente los **ejemplos** de uso.

```powershell
Get-Help -Name Get-Process
```

![Busqueda por nombre](Imagenes/Ej1_2.png)

Si queremos la ayuda completa, pondremos al final del comando `-Full`. Es decir:  
```powershell
Get-Help -Name Get-Process -Full
```

##  2. Exploraci贸n de objetos
- **Introspecci贸n de tipos:** ejecuta el comando para obtener la fecha actual (`Get-Date`) pero canaliza su salida para ver la lista de sus Miembros (Members).

Para ver los miembros, pondremos:  
```powershell
Get-Date | Get-Member
```

![Miembros](Imagenes/Ej2.png)

>  Comando demasiado largo para poner el resultado completo.

- **Responde:** 驴Cu谩l es el `TypeName` del objeto devuelto?.

Al poner `Get-Date | Get-Member`, al principio del todo, se indica el **TypeName** que en este caso es `System.DateTime`.

- **Identificaci贸n de Propiedades vs M茅todos:** usando el comando `Get-Member` sobre un proceso cualquiera (ej: `Get-Process`), identifica el nombre de un **M茅todo** que permita finalizar (matar) el proceso.

Podemos filtrar los resultados usando `-MemberType`.
```powershell
Get-Process | Get-Member -MemberType Method
```

![Metodos](Imagenes/Ej2_1.png)

Podemos ver enmarcado en rojo que hay un m茅todo llamado `Kill` con la definici贸n de `void Kill()`.  
Se puede filtrar mejor a煤n el resultado para que solo nos busque la palabra `Kill`.  
```powershell
Get-Process | Get-Member | Where-Object Name -eq "kill"
```

![Buscar Kill](Imagenes/Ej2_2.png)

##  3. El Pipeline (selecci贸n y ordenaci贸n)
- **Selecci贸n de columnas:** obt茅n la lista de todos los procesos, pero muestra por pantalla **煤nicamente** las propiedades `Id` y `ProcessName`. El resto de informaci贸n debe ser descartada.

```powershell
Get-Process | Select-Object Id, ProcessName
```

![Columnas](Imagenes/Ej3.png)

>  Comando demasiado largo para poner el resultado completo.

- **Ordenaci贸n b谩sica:** lista todos los procesos del sistema, ordenados por su consumo de `CPU` de forma **descendente** (el que m谩s consume primero).

```powershell
Get-Process | Sort-Object cpu -descending
```

![Procesos en descendiente](Imagenes/Ej3_1.png)

>  Comando demasiado largo para poner el resultado completo.

- **Formato de tabla:** obt茅n los servicios del sistema y fuerza la salida para que se muestre como una tabla (`Format-Table`) que se auto-ajuste (`-AutoSize`) al ancho de la ventana.

```powershell
Get-Service | Format-Table -AutoSize
```

![Tabla servicios](Imagenes/Ej3_2.png)

>  Comando demasiado largo para poner el resultado completo.

##  4. Filtrado y l贸gica (Where-Object)
- **Filtrado exacto:** muestra una lista de los servicios cuyo estado (`Status`) sea exactamente igual (`-eq`) a "Running".

```powershell
Get-Service | Where-Object Status -eq "Running"
```

![Servicios en Running](Imagenes/Ej4.png)

>  Comando demasiado largo para poner el resultado completo.

- **Filtrado num茅rico:** lista los procesos cuyo identificador (`Id`) sea mayor que (`-gt`) 2000.

```powershell
Get-Process | Where-Object Id -gt 2000
```

![Procesos mayores](Imagenes/Ej4_1.png)

>  Comando demasiado largo para poner el resultado completo.

- **Filtrado con comodines:** busca y muestra todos los procesos cuyo nombre (`Name`) comience por la letra "s" utilizando el operador `-like` y el comod铆n adecuado.

```powershell
Get-Process | Where-Object Name -like s*
```

![Procesos con s](Imagenes/Ej4_2.png)

>  Comando demasiado largo para poner el resultado completo.

##  5. Agrupaci贸n y estad铆sticas
- **Agrupaci贸n de datos:** agrupa todos los servicios del sistema en funci贸n de su `Status`. El comando debe devolverte cu谩ntos hay en cada grupo.

```powershell
Get-Service | Group-Object -Property Status
```

![Servicio con estado](Imagenes/Ej5.png)

- **C谩lculo estad铆stico:** obt茅n el listado de archivos del directorio actual (`Get-ChildItem`). Usando una tuber铆a, calcula el promedio (`Average`) de la propiedad `Length` (tama帽o) de todos los archivos.

```powershell
Get-ChildItem -File | Select-Object -ExpandProperty Length | Measure-Object -Average
```

![Tama帽o de archivos](Imagenes/Ej5_1.png)

##  6. Gesti贸n del Historial
- **Consulta de actividad:** muestra por pantalla la lista de los 煤ltimos comandos que has ejecutado en la sesi贸n actual.

```powershell
Get-History
```

Este comando muestra el historial de los comandos que se han puesto.

- **Exportaci贸n de datos:** exporta todo tu historial de comandos actual a un archivo en formato **CSV** llamado `historial_lab.csv`.

Como estoy haciendo los ejercicios en una m谩quina virtual, el archivo lo guardar茅 en `Documents`.
```powershell
Get-History | Export-Csv -Path 'C:\Users\alumno\Documents\historial_lab.csv'
```

![Historial comandos](Imagenes/Ej6.png)

Si lo abrimos ya sea con el Bloc de notas, Excel o Visual Studio, podremos ver la lista de los comandos que hayamos escrito.

---
### [猬锔 Volver a UT06](../index.md)
---