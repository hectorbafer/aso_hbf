#  PR0604: Manipulaci贸n de colecciones en PowerShell
>  Para hacer los ejercicios, se pondr谩 a la vez en el mismo cuadro el comando de entrada y de salida acompa帽ado de la captura de pantalla para ver el resultado.

##  Parte 1: Arrays fijos
###  1. Reconfiguraci贸n de DNS y Verificaci贸n
**Paso 1:** Declara el array con los valores iniciales: 192.168.1.10 (Primario) y 10.0.0.50 (Secundario err贸neo).
```powershell
$dns = @("192.168.1.10", "10.0.0.50")
```

>  El primero se encuentra en la posici贸n 0 y el segundo en la posici贸n 1.

**Paso 2:**
```powershell
"Configuraci贸n actual: $($dns[0]) - $($dns[1])"
```

![Configuraci贸n actual](Imagenes/Ej1-2.png)

**Paso 3:**
```powershell
$dns[1] = "8.8.8.8"
```

**Paso 4:**
```powershell
"N煤mero total de servidores DNS: $($dns.Count)"
```

![Contar DNS](Imagenes/Ej1-4.png)

**Paso 5:**
```powershell
"Configuraci贸n final: $($dns[0]) - $($dns[1])"
```

![Configuraci贸n final](Imagenes/Ej1-5.png)

###  2. Rotaci贸n de logs de backups (LIFO - Last In, First Out)
**Paso 1:**
```powershell
$backups = @("Backup_Lunes.zip", "Backup_Martes.zip", "Backup_Miercoles.zip")
```

**Paso 2:**
```powershell
$oldest = $backups[0]
```

**Paso 3:**
```powershell
$newest = $backups[2]
```

**Paso 4:**
```powershell
$backups[2] = $backups[2] + " (CORRUPTO)"
```

**Paso 5:**
```powershell
"Rotaci贸n de backups: Del $oldest al $($backups[2])"
```

![](Imagenes/Ej2-5.png)

##  Parte 2: ArrayList
###  3. Gesti贸n de Cola de incidencias (Priorizaci贸n)
**Paso 1:**
```powershell
$incidencias = New-Object System.Collections.ArrayList
```

**Paso 2:**
```powershell
[void]$incidencias.Add("Monitor parpadea")
[void]$incidencias.Add("Rat贸n no va")
```

**Paso 3:**
```powershell
$incidencias.Insert(0, "SERVIDOR CADO")
```

**Paso 4:**
```powershell
$incidencias.Remove("Rat贸n no va")
```

**Paso 5:**
```powershell
$incidencias
"Total de incidencias: $($incidencias.Count)"
```

![Resultado incidencias](Imagenes/Ej3-5.png)

###  4. Validaci贸n de lista negra de IPs (Seguridad)
**Paso 1:**
```powershell
$listaNegra = New-Object System.Collections.ArrayList
[void]$listaNegra.Add("10.10.10.5")
[void]$listaNegra.Add("192.168.50.4")
[void]$listaNegra.Add("80.80.80.80")
```

**Paso 2:**
```powershell
$NuevaAmenaza = "192.168.50.4"
```

**Paso 3:**
```powershell
if ($ListaNegra -contains $NuevaAmenaza) {
Write-Host "La IP $NuevaAmenaza ya estaba bloqueada. No se hace nada." -ForegroundColor Yellow
} else {
[void]$ListaNegra.Add($NuevaAmenaza)
Write-Host "La IP $NuevaAmenaza se ha a帽adido a la lista negra." -ForegroundColor Red
}
```

![Comprobar IP](Imagenes/Ej4-3.png)

**Paso 4:**
```powershell
$ListaNegra.Sort()
$ListaNegra
```

![Mostrar lista](Imagenes/Ej4-4.png)

##  Parte 3: Listas gen茅ricas
###  5. Hardening de puertos de Firewall (List[int])
**Paso 1:**
```powershell
$puertos = [System.Collections.Generic.List[int]]::new()
```

**Paso 2:**
```powershell
$puertos.Add(80)
$puertos.Add(443)
$puertos.Add(53)
```

**Paso 3:**
```powershell
$puertos.Add(23)
```

**Paso 4:**
```powershell
$puertos.Remove(23)
```

![Quitar puerto](Imagenes/Ej5-4.png)

**Paso 5:**
```powershell
$puertos.Add("HTTP")
```

![Error](Imagenes/Ej5-5.png)

>  Da error porque la lista solo acepta enteros *(int)* y no texto *(string)*

**Paso 6:**
```powershell
$puertos.Sort()
"Puertos autorizados en el Firewall (Hardened)"
$puertos
```

![Mostrar lista](Imagenes/Ej5-6.png)

###  6. Inventario de servicios cr铆ticos (List[string])
**Paso 1:**
```powershell
$arrayServicios = @("Spooler", "W3SVC", "LanmanWorkstation")
$servicios = [System.Collections.Generic.List[string]]::new([string[]]$arrayServicios)
```

**Paso 2:**
```powershell
$servicios.Add("wuauserv")
```

**Paso 3:**
```powershell
$serviciosOrdenados = $servicios | Sort-Object
```

**Paso 4:**
```powershell
foreach ($servicios in $serviciosOrdenados) {
"Monitorizando servicio: $($servicios) ...OK"}
```

![Monitorizar servicios](Imagenes/Ej6-4.png)

##  Parte 4: Manipulaci贸n de texto
###  7. An谩lisis de Log de usuario
**Entrada:**
```powershell
$logLine = " User: admin ; IP: 192.168.1.55 ; Status: Failed "
```
(Nota los espacios extra al principio y final).

**Paso 1:**
```powershell
$logLineLimpio = $logLine.Trim()
```

**Paso 2:**
```powershell
$partes = $logLineLimpio.Split(";")
```

**Paso 3:**
```powershell
$usuario = $partes[0].Split(":")[1].Trim()
```

**Paso 4:**
```powershell
$ip = $partes[1].Split(":")[1].Trim()
```

**Paso 5:**
```powershell
"ALERTA: El usuario $($usuario) intent贸 conectar desde $($ip)"
```

![Alerta](Imagenes/Ej7-5.png)

###  8. Generador de CSV para recursos humanos
**Paso 1:**
```powershell
$m1 = "ana@empresa.com"
$m2 = "luis@empresa.com"
$m3 = "bea@empresa.com"
```

**Paso 2:**
```powershell
$emails = @($m1, $m2, $m3)
```

**Paso 3:**
```powershell
$listaEmails = $emails -join ","
```

**Paso 4:**
```powershell
$csvFinal = "EmailAddress, $($listaEmails)"
```

**Paso 5:**
```powershell
$csvFinal
```

![Ver CSV](Imagenes/Ej8-5.png)

---
### [猬锔 Volver a UT06](../index.md)
---