# 游늯 PR0607: Limpieza de datos de usuarios

## 游늷 1. Objetivo
Trabajas como Administrador de Sistemas en la empresa *TechIberia S.L.*. El departamento de Recursos Humanos utiliza una aplicaci칩n antigua para registrar a las nuevas incorporaciones.

Cada lunes, RRHH te env칤a un fichero de texto plano con los datos de los nuevos empleados. Lamentablemente, el formato de salida de su aplicaci칩n es ca칩tico: todo est치 en may칰sculas, los delimitadores son extra침os y los campos est치n mezclados.

Tu objetivo es crear un script en PowerShell que lea estos datos "sucios", los procese utilizando manipulaci칩n de cadenas y exporte un archivo CSV limpio y profesional listo para ser importado a Active Directory o Microsoft 365.

## 游늷 2. Datos de entrada
Crea un fichero llamado `nuevos_empleados_raw.txt` con el siguiente contenido exacto (copia y pega):
```
GARCIA LOPEZ, ANA MARIA|MAD-VENTAS-01|1995/05/12
RUIZ DE LA TORRE, PEDRO|BCN-IT_SOPORTE-02|1988/11/23
O'CONNOR, SARAH JANE|BIO-MARKETING-05|2001/02/15
MARTINEZ, JOSE|SEV-LOGISTICA-09|1999/12/30
```

## 游늷 3. Requerimientos t칠cnicos
```powershell
$datosEntrada=@"
GARCIA LOPEZ, ANA MARIA|MAD-VENTAS-01|1995/05/12
RUIZ DE LA TORRE, PEDRO|BCN-IT_SOPORTE-02|1988/11/23
O'CONNOR, SARAH JANE|BIO-MARKETING-05|2001/02/15
MARTINEZ, JOSE|SEV-LOGISTICA-09|1999/12/30
"@ -split '\r?\n'

$objetosProcesados = foreach ($linea in $datosEntrada) {
    if ([string]::IsNullOrWhiteSpace($linea)) { continue }

    # Separar bloques por el delimitador principal |
    $partes = $linea -split "\|"
    
    # Nombre y Apellidos
    $nombreSucio = $partes[0].Split(',')
    $apellidosRaw = $nombreSucio[0].Trim()
    $nombreRaw    = $nombreSucio[1].Trim()
    
    # Formatear nombre
    $nombreCompleto = (Get-Culture).TextInfo.ToTitleCase(($nombreRaw + " " + $apellidosRaw).ToLower())

    # Generar Usuario
    $apellidoLimpio = $apellidosRaw.Split(' ')[0].ToLower()
    if ($apellidoLimpio.Length -gt 6) { $apellidoLimpio = $apellidoLimpio.Substring(0,6) }
    $usuarioRaw = $nombreRaw.Substring(0,1).ToLower() + $apellidoLimpio

    # Generar Email
    $email = ($nombreRaw + "." + $apellidosRaw).Replace(" ", ".").ToLower() + "@techiberia.com"

    # Departamento
    $deptRaw = $partes[1].Split('-')[1].Replace('_', ' ')

    # Contrase침a
    $anio = $partes[2].Split('/')[0]
    $password = "ChangeMe" + $anio + "!"

    [PSCustomObject]@{
        NombreCompleto  = $nombreCompleto
        Usuario         = $usuarioRaw
        Email           = $email
        Departamento    = $deptRaw
        PasswordInicial = $password
    }
}

$objetosProcesados | Export-Csv -Path "C:\Users\alumno\Documents\usuarios_importar.csv"
$objetosProcesados | Format-Table -AutoSize
```

## 游늷 4. Resultado
```
NombreCompleto         Usuario Email                                 Departamento PasswordInicial
--------------         ------- -----                                 ------------ ---------------
Ana Maria Garcia Lopez agarcia ana.maria.garcia.lopez@techiberia.com VENTAS       ChangeMe1995!
Pedro Ruiz De La Torre pruiz   pedro.ruiz.de.la.torre@techiberia.com IT SOPORTE   ChangeMe1988!
Sarah Jane O'connor    so'conn sarah.jane.o'connor@techiberia.com    MARKETING    ChangeMe2001!
Jose Martinez          jmartin jose.martinez@techiberia.com          LOGISTICA    ChangeMe1999!
```

---
### [拘勇 Volver a UT06](../index.md)
---