# üìÑ PR0203: Conexi√≥n remota con SSH entre redes

## ‚úÖ Objetivos
- Conectarse por **SSH** de manera transparente desde la m√°quina anfitriona hacia el **SERVER-A** con la cuenta de usuario creada.

- Conectarse por **SSH** de manera transparente desde la m√°quina **SERVER-A** hacia **SERVER-B** y **SERVER-C** con la cuenta de **sysadmin**.

## üì¶ Creaci√≥n de las m√°quinas
Creamos tres m√°quinas virtuales en **VirtualBox** de **Ubuntu Server 25.04** que ser√°n las siguientes:

|                | SERVER-A   | SERVER-B   | SERVER-C   |
|:--------------:|:----------:|:----------:|:----------:|
| **Usuario**    | hector     | sysadmin   | sysadmin   |
| **Hostname**   | server-a   | server-b   | server-c   |

En la instalaci√≥n, va a salir una ventana en si queremos instalar el servidor **SSH**, lo marcamos con **espacio** y despu√©s a **Hecho**.

![Instalar SSH](Imagenes/SSH.png)

Al **SERVER-A**, le ponemos **4** adaptadores de red, el primero en **NAT** y los dem√°s en **Adaptador solo anfitri√≥n**.

![Adaptador red SERVER-A](Imagenes/Red-A.png)

Las otras dos m√°quinas vamos a ponerles el primer adaptador en **NAT** y el secundario en **Adaptador solo anfitri√≥n**.

![Adaptador red SERVER-B y C](Imagenes/Red-BC.png)

## üîß Configurar la red de **SERVER-A**
Antes de todo, se pondr√° en una tabla las direcciones IP y el adaptador de red que deber√≠an de tener las m√°quinas.

| Adaptador    | SERVER-A           | SERVER-B      | SERVER-C      |
|:------------:|:------------------:|:-------------:|:-------------:|
| enp0s3       | NAT                | NAT           | NAT           |
| enp0s8       | 192.168.56.10/24   | 10.20.0.20/16 | 10.30.0.20/16 |
| enp0s9       | 10.20.0.10/16      | √ò             | √ò             |
| enp0s10      | 10.30.0.10/16      | √ò             | √ò             |

Cuando ya estemos dentro de SERVER-A, vamos a poner `ip a` para ver nuestros adaptadores de red y ver el nombre de adaptador para poder editarlos.

![ip a SERVER-A](Imagenes/ipa-A.png)

Vemos que solo el adaptador con el nombre **enp0s3** tiene IP y los dem√°s no, esto es por lo que hicimos antes.

Para las dem√°s m√°quinas, tendr√≠amos lo mismo pero con solo 2 adaptadores.

Para editar la red para que los adaptadores tengan IP, tenemos que editar el archivo `sudo nano /etc/netplan/50-cloud-init.yaml`. Esto, hay que hacerlo en las tres m√°quinas.

En principio, tendr√≠amos el archivo as√≠:

![Editar redes](Imagenes/netplan.png)

Para editarlo, tenemos que poner debajo del adaptador que ya tiene **IP**, por el que vamos a configurar, en este caso, ser√° el **enp0s8** y deber√≠a de quedarnos de √©sta manera:

![netplan A](Imagenes/netplan-A.png)

Ahora guardamos los cambios con `sudo netplan apply` y volvemos a poner `ip a`, veremos que el adaptador que hemos configurado ya tiene la IP de manera est√°tica.

![ip a SERVER-A](Imagenes/ipa1.png)

Para comprobar que todo haya funcionado, nos conectaremos por **SSH** desde nuestra m√°quina anfitriona al **SERVER-A**.

![SSH SERVER-A](Imagenes/ssh_A_1.png)

Ahora desde la terminal de nuestra m√°quina anfitriona configuramos las dem√°s **IPs** para las dem√°s m√°quinas.



---
### [‚¨ÖÔ∏è Volver a UT02](../index.md)
---